DROP SOURCE IF EXISTS SOURCE___TERA_VIEW_NAME__ CASCADE;

CREATE SOURCE SOURCE___TERA_VIEW_NAME__
FROM KAFKA BROKER __SED_BROKER_URL__ TOPIC 'CMS_BDM_VIEW_OPI_AAL-__TERA_VIEW_NAME__'
KEY FORMAT BYTES
VALUE FORMAT BYTES
ENVELOPE UPSERT;

CREATE MATERIALIZED VIEW __M-VIEW-NAME__ AS
SELECT

-- INSERT CODE HERE --

FROM (
  SELECT cast(data::jsonb->>'payload' as String) as payload
  FROM (
    SELECT CONVERT_FROM(data, 'utf8') AS data
    FROM SOURCE___TERA_VIEW_NAME__
  )
);